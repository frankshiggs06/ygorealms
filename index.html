<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seguimiento de Duelistas - Yu-Gi-Oh!</title>
    <!-- Carga de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- NUEVO: Enlace al archivo de estilos -->
    <link rel="stylesheet" href="./style.css">
</head>
<body class="min-h-screen p-4 sm:p-8">

    <!-- Pantalla de Inicio de Sesi贸n (Se muestra al inicio) -->
    <div id="login-screen" class="modal-overlay flex">
        <div class="card p-6 rounded-xl text-white w-full max-w-sm">
            <h2 class="text-3xl font-extrabold mb-6 text-center text-yellow-400">Iniciar Sesi贸n</h2>
            <div class="space-y-4">
                <div>
                    <label for="login-username" class="block text-sm font-medium text-gray-300 mb-2">Nombre de Usuario:</label>
                    <input type="text" id="login-username" placeholder="Tu nombre de duelista" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label for="login-password" class="block text-sm font-medium text-gray-300 mb-2">Contrase帽a:</label>
                    <input type="password" id="login-password" placeholder="Tu contrase帽a" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <button id="login-button" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                    Entrar al Torneo
                </button>
                <p id="login-feedback" class="text-red-400 text-sm h-5 text-center"></p>
                <p id="db-loading-feedback" class="text-yellow-300 text-sm h-5 text-center">Conectando a la base de datos...</p>
            </div>
        </div>
    </div>

    <!-- Contenido principal de la aplicaci贸n (oculto por defecto) -->
    <div id="app-content" class="hidden">

        <!-- Encabezado Fijo y Navegaci贸n -->
        <header class="header-bg p-4 rounded-lg mb-8 shadow-xl text-white">
            <div class="max-w-6xl mx-auto flex flex-col sm:flex-row justify-between items-center">
                <h1 class="text-3xl font-bold tracking-tight mb-2 sm:mb-0">
                    Torneo de Duelistas 
                </h1>
                <nav class="space-x-4">
                    <a href="#usuarios" class="hover:text-gray-200 transition duration-150 font-medium">Usuarios</a>
                    <a href="#packs" class="hover:text-gray-200 transition duration-150 font-medium">Packs</a>
                    <a href="#ranking" class="hover:text-gray-200 transition duration-150 font-medium">Ranking</a>
                    <!-- NUEVO: Enlace al Marketplace -->
                    <a href="#marketplace" class="hover:text-gray-200 transition duration-150 font-medium">Marketplace</a>
                    <a href="#admin" class="hover:text-gray-200 transition duration-150 font-medium">Admin</a>
                    <a href="#juegos" class="hover:text-gray-200 transition duration-150 font-medium">Juegos</a>
                    <a href="#historia" class="hover:text-gray-200 transition duration-150 font-medium">Historia</a>
                </nav>
            </div>
            <!-- Muestra Usuario -->
            <div class="max-w-6xl mx-auto text-center mt-2 space-y-1">
                <span class="text-xs text-gray-200 block">Usuario Conectado: <strong id="logged-in-user-display" class="font-mono text-yellow-300">Ninguno</strong></span>
            </div>
        </header>

        <main class="max-w-6xl mx-auto space-y-12">

            <!-- Secci贸n 1: Usuarios (Tabla de Puntos DP) -->
            <section id="usuarios" class="card p-6 rounded-xl text-white">
                <h2 class="text-3xl font-extrabold mb-6 text-yellow-400 border-b border-yellow-400/50 pb-2">
                     Usuarios y Puntuaci贸n DP
                </h2>

                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-600">
                        <thead class="bg-gray-700/50">
                            <tr>
                                <th scope="col" class="px-4 py-3 text-left text-xs font-bold uppercase tracking-wider text-gray-300">
                                    Jugador
                                </th>
                                <th scope="col" class="px-4 py-3 text-left text-xs font-bold uppercase tracking-wider text-gray-300">
                                    Puntos DP
                                </th>
                                <th scope="col" class="px-4 py-3 text-left text-xs font-bold uppercase tracking-wider text-gray-300">
                                    Deck Inicial
                                </th>
                            </tr>
                        </thead>
                        <tbody id="user-table-body" class="divide-y divide-gray-700">
                            <tr>
                                <td colspan="3" class="px-4 py-4 text-center text-gray-400">Cargando jugadores...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <p class="mt-6 text-sm text-gray-400">
                    *Los Puntos DP (Duelist Points) se usan para adquirir nuevos packs y mejorar tu colecci贸n.
                </p>
            </section>

            <!-- Secci贸n 2: Packs (Tienda/Adquisici贸n) -->
            <section id="packs" class="card p-6 rounded-xl text-white">
                <h2 class="text-3xl font-extrabold mb-6 text-blue-400 border-b border-blue-400/50 pb-2">
                     Packs de Cartas
                </h2>
                
                <div class="mb-6">
                    <p class="text-lg text-gray-300">Est谩s comprando como: <strong id="pack-buyer-display" class="text-yellow-300">...</strong></p>
                    <p id="purchase-feedback" class="text-yellow-300 text-sm mt-2 h-5 feedback-message opacity-0"></p>
                </div>

                <!-- Contenedor de Grid para los packs -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    
                    <!-- Pack 1: Poder del Mago (Yugi/Pegasus) -->
                    <div class="bg-gray-700 p-4 rounded-lg border-2 border-gray-600 hover:border-purple-500 transition duration-300 flex flex-col">
                        <img src="https://placehold.co/300x300/6b21a8/ffffff?text=Poder+del+Mago" alt="Poder del Mago" class="pack-image">
                        <h3 class="text-xl font-bold mb-2 text-purple-300">Poder del Mago</h3>
                        <p class="text-3xl font-extrabold text-yellow-400 mb-3">150 DP</p>
                        <ul class="text-sm space-y-1 text-gray-400 flex-grow">
                            <li>Contiene 5 Cartas.</li>
                            <li>Soporte para Decks de Hechiceros y Rituales.</li>
                            <li>Ideal para Yugi y Pegasus.</li>
                        </ul>
                        <button id="buy-pack-1" data-cost="150" data-name="Poder del Mago" class="mt-4 w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 disabled:opacity-50">
                            Comprar (150 DP)
                        </button>
                    </div>
                    
                    <!-- Pack 2: Furia del Drag贸n (Kaiba/Joey) -->
                    <div class="bg-gray-700 p-4 rounded-lg border-2 border-gray-600 hover:border-blue-500 transition duration-300 flex flex-col">
                        <img src="https://placehold.co/300x300/1d4ed8/ffffff?text=Furia+del+Drag贸n" alt="Furia del Drag贸n" class="pack-image">
                        <h3 class="text-xl font-bold mb-2 text-blue-300">Furia del Drag贸n</h3>
                        <p class="text-3xl font-extrabold text-yellow-400 mb-3">150 DP</p>
                        <ul class="text-sm space-y-1 text-gray-400 flex-grow">
                            <li>Contiene 5 Cartas.</li>
                            <li>Soporte para Decks de Dragones y Guerreros.</li>
                            <li>Ideal para Kaiba y Joey.</li>
                        </ul>
                        <button id="buy-pack-2" data-cost="150" data-name="Furia del Drag贸n" class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 disabled:opacity-50">
                            Comprar (150 DP)
                        </button>
                    </div>

                    <!-- Pack 3: Arsenal del Duelista (Staples) -->
                    <div class="bg-gray-700 p-4 rounded-lg border-2 border-gray-600 hover:border-yellow-500 transition duration-300 flex flex-col">
                        <img src="https://placehold.co/300x300/ca8a04/ffffff?text=Arsenal+del+Duelista" alt="Arsenal del Duelista" class="pack-image">
                        <h3 class="text-xl font-bold mb-2 text-yellow-300">Arsenal del Duelista</h3>
                        <p class="text-3xl font-extrabold text-yellow-400 mb-3">300 DP</p>
                        <ul class="text-sm space-y-1 text-gray-400 flex-grow">
                            <li>Contiene 5 Cartas.</li>
                            <li>Cartas "Staple" gen茅ricas de Magia/Trampa.</li>
                            <li>Garantiza 1 S煤per Rara.</li>
                        </ul>
                        <button id="buy-pack-3" data-cost="300" data-name="Arsenal del Duelista" class="mt-4 w-full bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 disabled:opacity-50">
                            Comprar (300 DP)
                        </button>
                    </div>

                    <!-- PACK 4: Tesoro del Fara贸n (Alto Riesgo) -->
                    <div class="bg-gray-700 p-4 rounded-lg border-2 border-gray-600 hover:border-amber-300 transition duration-300 flex flex-col">
                        <img src="https://placehold.co/300x300/a16207/ffffff?text=Tesoro+del+Fara贸n" alt="Tesoro del Fara贸n" class="pack-image">
                        <h3 class="text-xl font-bold mb-2 text-amber-300">Tesoro del Fara贸n</h3>
                        <p class="text-3xl font-extrabold text-yellow-400 mb-3">500 DP</p>
                        <ul class="text-sm space-y-1 text-gray-400 flex-grow">
                            <li>Contiene 5 Cartas.</li>
                            <li>Alto riesgo, alta recompensa.</li>
                            <li>Posibilidad de Staples de poder (SR) o cartas "Exodia".</li>
                        </ul>
                        <button id="buy-pack-4" data-cost="500" data-name="Tesoro del Fara贸n" class="mt-4 w-full bg-amber-600 hover:bg-amber-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 disabled:opacity-50">
                            Comprar (500 DP)
                        </button>
                    </div>

                    <!-- PACK 5: Legado del Ojo Azul (Poder Kaiba) -->
                    <div class="bg-gray-700 p-4 rounded-lg border-2 border-gray-600 hover:border-cyan-300 transition duration-300 flex flex-col">
                        <img src="https://placehold.co/300x300/0e7490/ffffff?text=Legado+del+Ojo+Azul" alt="Legado del Ojo Azul" class="pack-image">
                        <h3 class="text-xl font-bold mb-2 text-cyan-300">Legado del Ojo Azul</h3>
                        <p class="text-3xl font-extrabold text-yellow-400 mb-3">1000 DP</p>
                        <ul class="text-sm space-y-1 text-gray-400 flex-grow">
                            <li>Contiene 7 Cartas.</li>
                            <li>Cartas de poder enfocadas en Dragones y M谩quinas.</li>
                            <li>Garantiza 2 S煤per Raras.</li>
                        </ul>
                        <button id="buy-pack-5" data-cost="1000" data-name="Legado del Ojo Azul" class="mt-4 w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 disabled:opacity-50">
                            Comprar (1000 DP)
                        </button>
                    </div>

                    <!-- PACK 6: El Cofre Prohibido (Definitivo) -->
                    <div class="bg-gray-700 p-4 rounded-lg border-2 border-gray-600 hover:border-red-500 transition duration-300 flex flex-col">
                        <img src="https://placehold.co/300x300/b91c1c/ffffff?text=El+Cofre+Prohibido" alt="El Cofre Prohibido" class="pack-image">
                        <h3 class="text-xl font-bold mb-2 text-red-300">El Cofre Prohibido</h3>
                        <p class="text-3xl font-extrabold text-yellow-400 mb-3">1500 DP</p>
                        <ul class="text-sm space-y-1 text-gray-400 flex-grow">
                            <li>Contiene 7 Cartas.</li>
                            <li>Solo contiene cartas Raras, S煤per Raras y Ultra Raras.</li>
                            <li>Garantiza 1 Ultra Rara.</li>
                        </ul>
                        <button id="buy-pack-6" data-cost="1500" data-name="El Cofre Prohibido" class="mt-4 w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 disabled:opacity-50">
                            Comprar (1500 DP)
                        </button>
                    </div>

                </div>
            </section>

            <!-- Ranking Semanal -->
            <section id="ranking" class="card p-6 rounded-xl text-white">
                <h2 class="text-3xl font-extrabold mb-6 text-green-400 border-b border-green-400/50 pb-2">
                     Ranking Semanal
                </h2>
                <p class="text-gray-300 mb-6">Jugadores ordenados por victorias esta semana (Lunes a Domingo).</p>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-600">
                        <thead class="bg-gray-700/50">
                            <tr>
                                <th scope="col" class="px-4 py-3 text-left text-xs font-bold uppercase tracking-wider text-gray-300">Pos.</th>
                                <th scope="col" class="px-4 py-3 text-left text-xs font-bold uppercase tracking-wider text-gray-300">Jugador</th>
                                <th scope="col" class="px-4 py-3 text-left text-xs font-bold uppercase tracking-wider text-gray-300">Victorias Semanales</th>
                            </tr>
                        </thead>
                        <tbody id="ranking-table-body" class="divide-y divide-gray-700">
                            <tr><td colspan="3" class="px-4 py-4 text-center text-gray-400">Cargando ranking...</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- NUEVA SECCIN: Marketplace -->
            <section id="marketplace" class="card p-6 rounded-xl text-white">
                <h2 class="text-3xl font-extrabold mb-6 text-teal-400 border-b border-teal-400/50 pb-2">
                     Marketplace
                </h2>
                <p class="text-gray-300 mb-6">
                    Compra y vende cartas con otros duelistas. La casa cobra una comisi贸n del 10% sobre todas las ventas.
                </p>

                <!-- Contenedor del Marketplace (Vender y Comprar) -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    
                    <!-- Columna de Venta -->
                    <div>
                        <h3 class="text-xl font-bold mb-4 text-gray-100">Vender una Carta</h3>
                        <div class="space-y-4 p-4 bg-gray-700/50 rounded-lg border border-gray-600">
                            <div>
                                <label for="market-sell-card-select" class="block text-sm font-medium text-gray-300 mb-2">Carta de tu Inventario:</label>
                                <select id="market-sell-card-select" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500">
                                    <option>Carga tu inventario...</option>
                                </select>
                            </div>
                            <div>
                                <label for="market-sell-price" class="block text-sm font-medium text-gray-300 mb-2">Precio de Venta (DP):</label>
                                <input type="number" id="market-sell-price" min="1" placeholder="Ej: 500" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-teal-500">
                            </div>
                            <button id="market-sell-button" class="w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                                Poner en Venta
                            </button>
                            <p id="market-sell-feedback" class="text-center text-yellow-300 text-sm h-5 feedback-message opacity-0"></p>
                        </div>
                    </div>

                    <!-- Columna de Compra -->
                    <div>
                        <h3 class="text-xl font-bold mb-4 text-gray-100">Listados Actuales</h3>
                        <div class="overflow-y-auto max-h-[400px] bg-gray-900 p-2 rounded-lg border border-gray-600">
                            <table class="min-w-full divide-y divide-gray-700 market-table">
                                <thead class="bg-gray-700 sticky top-0">
                                    <tr>
                                        <th class_="" scope="col">Carta</th>
                                        <th scope="col">Precio</th>
                                        <th scope="col">Vendedor</th>
                                        <th scope="col">Acci贸n</th>
                                    </tr>
                                </thead>
                                <tbody id="market-listings-body" class="divide-y divide-gray-800">
                                    <tr><td colspan="4" class="px-3 py-4 text-center text-gray-400">Cargando listados...</td></tr>
                                </tbody>
                            </table>
                        </div>
                        <p id="market-buy-feedback" class="text-center text-yellow-300 text-sm h-5 mt-4 feedback-message opacity-0"></p>
                    </div>
                </div>
            </section>

            <!-- Panel de Administraci贸n -->
            <section id="admin" class="card p-6 rounded-xl text-white">
                <h2 class="text-3xl font-extrabold mb-6 text-indigo-400 border-b border-indigo-400/50 pb-2">
                    锔 Panel de Administraci贸n
                </h2>

                <!-- Bloqueo de Contrase帽a -->
                <div id="admin-lock-screen" class="space-y-4 text-center p-4 bg-gray-700/50 rounded-lg border border-gray-600">
                    <label for="admin-password" class="block text-lg font-medium text-gray-300 mb-2">Se requiere contrase帽a de administrador:</label>
                    <input type="password" id="admin-password" placeholder="Contrase帽a" class="w-full max-w-sm mx-auto bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    <button id="admin-unlock-button" class="w-full max-w-sm mx-auto bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300" disabled>
                        Desbloquear
                    </button>
                    <p id="admin-lock-feedback" class="text-red-400 text-sm mt-2 h-5"></p>
                    <p class="text-xs text-gray-400">Debes iniciar sesi贸n como usuario primero.</p>
                </div>

                <!-- Contenido del Admin (oculto por defecto) -->
                <div id="admin-content" class="hidden">
                    <!-- Formulario para Registrar Duelos -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <div>
                            <h3 class="text-xl font-bold mb-3 text-gray-100">Registrar Duelo</h3>
                            <div class="space-y-4">
                                <div>
                                    <label for="admin-player-select" class="block text-sm font-medium text-gray-300 mb-2">Ganador:</label>
                                    <select id="admin-player-select" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                        <option>Cargando...</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="admin-player-select-loser" class="block text-sm font-medium text-gray-300 mb-2">Perdedor:</label>
                                    <select id="admin-player-select-loser" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                        <option>Cargando...</option>
                                    </select>
                                </div>
                                <div class="flex items-center">
                                    <input id="admin-surrender-checkbox" type="checkbox" class="h-4 w-4 bg-gray-700 border-gray-600 text-indigo-600 focus:ring-indigo-500 rounded">
                                    <label for="admin-surrender-checkbox" class="ml-2 block text-sm text-gray-300">
                                        El perdedor se rindi贸 (Surrender)
                                    </label>
                                </div>
                                <p class="text-xs text-gray-400 -mt-2 ml-6">(+50 DP extra al ganador, -50 DP al perdedor)</p>
                                
                                <div class="flex items-center">
                                    <input id="admin-flawless-checkbox" type="checkbox" class="h-4 w-4 bg-gray-700 border-gray-600 text-indigo-600 focus:ring-indigo-500 rounded">
                                    <label for="admin-flawless-checkbox" class="ml-2 block text-sm text-gray-300">
                                        Ganador no perdi贸 LP (Flawless)
                                    </label>
                                </div>
                                <p class="text-xs text-gray-400 -mt-2 ml-6">(+100 DP extra al ganador)</p>

                                <button id="admin-submit-button" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 mt-4">
                                    Registrar Duelo
                                </button>
                            </div>
                        </div>
                        
                        <!-- Formulario para A帽adir Nuevo Jugador -->
                        <div>
                            <h3 class="text-xl font-bold mb-3 text-gray-100">A帽adir Nuevo Jugador</h3>
                            <div class="space-y-4">
                                <div>
                                    <label for="admin-new-player-name" class="block text-sm font-medium text-gray-300 mb-2">Nombre:</label>
                                    <input type="text" id="admin-new-player-name" placeholder="Nombre del Duelista" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                </div>
                                <div>
                                    <label for="admin-new-player-deck" class="block text-sm font-medium text-gray-300 mb-2">Deck Inicial:</label>
                                    <select id="admin-new-player-deck" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                        <option>Yugi</option>
                                        <option>Kaiba</option>
                                        <option>Joey</option>
                                        <option>Pegasus</option>
                                        <option>Otro</option>
                                    </select>
                                </div>
                                <button id="admin-add-player-button" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                                    A帽adir Jugador
                                </button>
                            </div>
                        </div>
                    </div>
                    <p id="admin-feedback" class="text-center text-yellow-300 text-sm mt-2 h-5 feedback-message opacity-0"></p>

                    <!-- Gesti贸n Semanal -->
                    <hr class="border-gray-600 my-8">
                    <div>
                        <h3 class="text-xl font-bold mb-3 text-gray-100">Gesti贸n Semanal</h3>
                        <p class="text-sm text-gray-400 mb-4">
                            Al cerrar la semana, se anunciar谩 al ganador en la historia y se reiniciar谩n todas las victorias semanales a 0.
                        </p>
                        <button id="admin-reset-week-button" class="w-full max-w-sm mx-auto bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                            Cerrar Semana y Reiniciar Ranking
                        </button>
                        <p id="admin-week-feedback" class="text-center text-yellow-300 text-sm mt-2 h-5 feedback-message opacity-0"></p>
                    </div>

                    <!-- Inventario de Cartas Adquiridas -->
                    <hr class="border-gray-600 my-8">
                    <div>
                        <h3 class="text-xl font-bold mb-3 text-gray-100">Inventario de Cartas</h3>
                        <p class="text-sm text-gray-400 mb-4">
                            Selecciona un jugador para ver todas las cartas que ha adquirido en los packs.
                        </p>
                        <div>
                            <label for="admin-card-inventory-select" class="block text-sm font-medium text-gray-300 mb-2">Seleccionar Jugador:</label>
                            <select id="admin-card-inventory-select" class="w-full max-w-sm bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                <option>Cargando...</option>
                            </select>
                        </div>
                        
                        <h4 class="text-lg font-semibold mt-6 mb-3 text-gray-200">Colecci贸n:</h4>
                        <ul id="admin-card-inventory-list" class="space-y-2 bg-gray-900 p-4 rounded-lg border border-gray-600 min-h-[150px] max-h-60 overflow-y-auto">
                            <li class="text-gray-400">Selecciona un jugador para ver su inventario.</li>
                        </ul>
                    </div>

                    <!-- NUEVO: Reseteo de F谩brica -->
                    <hr class="border-gray-600 my-8">
                    <div>
                        <h3 class="text-xl font-bold mb-3 text-red-400">Zona de Peligro - Reseteo Total</h3>
                        <p class="text-sm text-gray-400 mb-4">
                            Esto borrar谩 TODOS los jugadores, CUALQUIER inventario, TODA la historia y TODOS los listados del marketplace.
                            La base de datos se reiniciar谩 con los 3 jugadores base en 0 DP. Esta acci贸n es irreversible.
                        </p>
                        <button id="admin-factory-reset-button" class="w-full max-w-sm mx-auto bg-red-800 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 factory-reset-button" data-confirmed="false">
                            Iniciar Reseteo de F谩brica
                        </button>
                        <p id="admin-reset-feedback" class="text-center text-red-300 text-sm mt-2 h-5 feedback-message opacity-0"></p>
                    </div>

                </div>
            </section>
            
            <!-- SECCIN DE JUEGOS (MODIFICADA) -->
            <section id="juegos" class="card p-6 rounded-xl text-white">
                <h2 class="text-3xl font-extrabold mb-6 text-pink-400 border-b border-pink-400/50 pb-2">
                     Sala de Juegos (Apuestas DP)
                </h2>
                <p class="text-gray-300 mb-6">
                    驴Te sientes con suerte, duelista? Cada juego se puede jugar 3 veces al d铆a. El l铆mite se reinicia 24 horas despu茅s de tu primera partida.
                </p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Juego 1: Eternals BetCards (Activo) -->
                    <div id="open-game-1" class="game-card">
                        <div>
                            <h3 class="game-card-title text-pink-300">Eternals BetCards</h3>
                            <p class="game-card-description">
                                1 de 3 cartas gana (1.5x).
                            </p>
                        </div>
                        <button id="game-1-button" class="w-full bg-pink-600 hover:bg-pink-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 disabled:opacity-50" disabled>
                            <span id="game-1-button-text">Jugar (3/3 Oportunidades)</span>
                        </button>
                    </div>

                    <!-- Juego 2: Duelo de Dados (Activo) -->
                    <div id="open-game-2" class="game-card">
                        <div>
                            <h3 class="game-card-title text-green-300">Duelo de Dados</h3>
                            <p class="game-card-description">
                                Apuesta al resultado de 2 dados. (< 7 = 2x, = 7 = 5x, > 7 = 2x).
                            </p>
                        </div>
                        <button id="game-2-button" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 disabled:opacity-50" disabled>
                            <span id="game-2-button-text">Jugar (3/3 Oportunidades)</span>
                        </button>
                    </div>
                    
                    <!-- Juego 3: La Moneda del Milenio (Activo) -->
                    <div id="open-game-3" class="game-card">
                        <div>
                            <h3 class="game-card-title text-yellow-300">Moneda del Milenio</h3>
                            <p class="game-card-description">
                                Un simple 50/50. Ganas 1.9x (la casa cobra 10% de comisi贸n).
                            </p>
                        </div>
                        <button id="game-3-button" class="w-full bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300 disabled:opacity-50" disabled>
                            <span id="game-3-button-text">Jugar (3/3 Oportunidades)</span>
                        </button>
                    </div>

                    <!-- Juego 4: (Pr贸ximamente) -->
                    <div class="game-card disabled">
                        <div>
                            <h3 class="game-card-title text-gray-500">Ruleta de Exodia</h3>
                            <p class="game-card-description">
                                Pr贸ximamente...
                            </p>
                        </div>
                        <button class="w-full bg-gray-600 text-gray-400 font-bold py-2 px-4 rounded-lg" disabled>
                            Pr贸ximamente...
                        </button>
                    </div>
                    
                    <!-- Juego 5: (Pr贸ximamente) -->
                    <div class="game-card disabled">
                        <div>
                            <h3 class="game-card-title text-gray-500">Jackpot del Mago</h3>
                            <p class="game-card-description">
                                Pr贸ximamente...
                            </p>
                        </div>
                        <button class="w-full bg-gray-600 text-gray-400 font-bold py-2 px-4 rounded-lg" disabled>
                            Pr贸ximamente...
                        </button>
                    </div>

                    <!-- Juego 6: (Pr贸ximamente) -->
                    <div class="game-card disabled">
                        <div>
                            <h3 class="game-card-title text-gray-500">Ojo de Anubis</h3>
                            <p class="game-card-description">
                                Pr贸ximamente...
                            </p>
                        </div>
                        <button class="w-full bg-gray-600 text-gray-400 font-bold py-2 px-4 rounded-lg" disabled>
                            Pr贸ximamente...
                        </button>
                    </div>
                </div>
            </section>

            <!-- Historia de Eventos -->
            <section id="historia" class="card p-6 rounded-xl text-white">
                <h2 class="text-3xl font-extrabold mb-6 text-green-400 border-b border-green-400/50 pb-2">
                     Historia de Puntos y Eventos
                </h2>
                <p class="text-gray-300 mb-6">Registro de todos los cambios importantes en el progreso de los duelistas (en tiempo real).</p>

                <ul id="history-list" class="space-y-4">
                    <li class="bg-gray-700 p-3 rounded-lg text-center text-gray-400">Cargando historial...</li>
                </ul>
            </section>

        </main>

        <!-- Modal de Apertura de Pack -->
        <div id="pack-opening-modal" class="modal-overlay hidden opacity-0 visibility-hidden">
            <div class="modal-content">
                <h3 class="text-2xl font-bold mb-4 text-center text-yellow-300">隆Pack Adquirido!</h3>
                <p class="text-center text-gray-400 text-sm mb-4">隆Estas son las cartas que obtuviste! (Nombres en Ingl茅s para YGOPro):</p>
                
                <ul id="pack-card-list" class="space-y-2 bg-gray-900 p-4 rounded-lg border border-gray-600 mb-6 min-h-[150px]">
                    <!-- Las cartas se insertar谩n aqu铆 din谩micamente -->
                </ul>
                
                <button id="modal-close-pack-button" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                    Aceptar
                </button>
            </div>
        </div>

        <!-- --- MODALES DE JUEGOS --- -->

        <!-- Modal de Juego 1: Eternals BetCards -->
        <div id="game-1-modal" class="modal-overlay hidden opacity-0 visibility-hidden">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-2xl font-bold text-center text-pink-300">Eternals BetCards</h3>
                    <button id="game-1-close-button" class="text-gray-400 hover:text-white text-3xl">&times;</button>
                </div>
                
                <!-- Paso 1: Seleccionar Apuesta -->
                <div id="game-1-step-1">
                    <p class="text-center text-gray-300 mb-4">Selecciona tu apuesta. 1 de 3 cartas es la ganadora (Premio: 1.5x).</p>
                    <div id="game-1-bet-options" class="flex justify-center gap-2 flex-wrap mb-4">
                        <button class="bet-button" data-bet="50">50 DP</button>
                        <button class="bet-button" data-bet="100">100 DP</button>
                        <button class="bet-button" data-bet="150">150 DP</button>
                        <button class="bet-button" data-bet="200">200 DP</button>
                        <button class="bet-button" data-bet="500">500 DP</button>
                    </div>
                </div>

                <!-- Paso 2: Elegir Carta -->
                <div id="game-1-step-2" class="hidden">
                    <p class="text-center text-gray-300 mb-4">隆Apuesta seleccionada! Ahora, elige tu carta. 隆Suerte!</p>
                </div>

                <!-- El Juego -->
                <div id="game-1-grid" class="opacity-50 pointer-events-none">
                    <div class="bet-card" data-index="0">
                        <div class="card-face card-front"></div>
                        <div class="card-face card-back"></div>
                    </div>
                    <div class="bet-card" data-index="1">
                        <div class="card-face card-front"></div>
                        <div class="card-face card-back"></div>
                    </div>
                    <div class="bet-card" data-index="2">
                        <div class="card-face card-front"></div>
                        <div class="card-face card-back"></div>
                    </div>
                </div>
                <p id="game-1-feedback" class="text-center text-yellow-300 h-5 mt-4"></p>
            </div>
        </div>
        
        <!-- Modal de Juego 2: Duelo de Dados -->
        <div id="game-2-modal" class="modal-overlay hidden opacity-0 visibility-hidden">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-2xl font-bold text-center text-green-300">Duelo de Dados</h3>
                    <button id="game-2-close-button" class="text-gray-400 hover:text-white text-3xl">&times;</button>
                </div>
                
                <div id="game-2-step-1">
                    <p class="text-center text-gray-300 mb-4">Selecciona tu apuesta base:</p>
                    <div id="game-2-bet-options" class="flex justify-center gap-2 flex-wrap mb-4">
                        <button class="bet-button" data-bet="50">50 DP</button>
                        <button class="bet-button" data-bet="100">100 DP</button>
                        <button class="bet-button" data-bet="150">150 DP</button>
                    </div>
                </div>

                <div id="game-2-step-2" class="hidden">
                    <p class="text-center text-gray-300 mb-4">Apuesta: <span id="game-2-bet-display" class="font-bold text-white">0</span> DP. 驴Cu谩l ser谩 el resultado?</p>
                    <div class="grid grid-cols-3 gap-2 mb-4">
                        <button id="game-2-choice-low" class="bet-button text-lg py-3">Menor que 7 (x2)</button>
                        <button id="game-2-choice-seven" class="bet-button text-lg py-3">Igual a 7 (x5)</button>
                        <button id="game-2-choice-high" class="bet-button text-lg py-3">Mayor que 7 (x2)</button>
                    </div>
                </div>
                
                <div id="game-2-dice-container">
                    <div id="game-2-dice-1" class="dice">?</div>
                    <div id="game-2-dice-2" class="dice">?</div>
                </div>
                
                <p id="game-2-feedback" class="text-center text-yellow-300 h-5 mt-4"></p>
            </div>
        </div>

        <!-- Modal de Juego 3: Moneda del Milenio -->
        <div id="game-3-modal" class="modal-overlay hidden opacity-0 visibility-hidden">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-2xl font-bold text-center text-yellow-300">Moneda del Milenio</h3>
                    <button id="game-3-close-button" class="text-gray-400 hover:text-white text-3xl">&times;</button>
                </div>
                
                <div id="game-3-step-1">
                    <p class="text-center text-gray-300 mb-4">Selecciona tu apuesta (Premio: 1.9x):</p>
                    <div id="game-3-bet-options" class="flex justify-center gap-2 flex-wrap mb-4">
                        <button class="bet-button" data-bet="50">50 DP</button>
                        <button class="bet-button" data-bet="100">100 DP</button>
                        <button class="bet-button" data-bet="150">150 DP</button>
                    </div>
                </div>

                <div id="game-3-step-2" class="hidden">
                    <p class="text-center text-gray-300 mb-4">Apuesta: <span id="game-3-bet-display" class="font-bold text-white">0</span> DP. Elige tu destino:</p>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <button id="game-3-choice-heads" class="bet-button text-lg py-4">CARA</button>
                        <button id="game-3-choice-tails" class="bet-button text-lg py-4">CRUZ</button>
                    </div>
                </div>
                
                <div id="game-3-coin" class="hidden">?</div>
                
                <p id="game-3-feedback" class="text-center text-yellow-300 h-5 mt-4"></p>
            </div>
        </div>
        
        <footer class="mt-12 text-center text-gray-500 text-sm">
            <p>Hecho para el seguimiento de tu duelo.</p>
        </footer>
    
    </div> <!-- Fin de #app-content -->

    <!-- 
      NUEVO: Enlace al archivo de JavaScript. 
      Lo ponemos al final del body para que cargue despu茅s del HTML.
      Usamos type="module" porque dentro de main.js importamos Firebase.
    -->
    <script type="module" src="./main.js"></script>
    
</body>
</html>


